webpackJsonp([21],{BhC5:function(t,e){},OfL9:function(t,e){},ZP6n:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),n=a("Dd8w"),o=a.n(n),l=a("6jqi"),r={mixins:[l.a],props:{courseId:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{showEdit:!1,searchLoading:!1,dataColumns:[{prop:"attribute",label:"属性",slot:!0,width:100},{prop:"name",label:"名称",slot:!0},{prop:"fileType",label:"文件类型",width:80},{prop:"size",label:"大小",slot:!0,width:100},{prop:"createTime",label:"创建时间",slot:!0,width:100},{prop:"oprate",label:"操作",slot:!0,width:220}],dataList:[],fileTypeOptions:[],fileType:"",selectFiles:[],preSelectFile:[],propsOption:{key:"materialId",label:"name"},progress:0,attributeOptions:[{label:"课前",value:1},{label:"课中",value:2},{label:"课后",value:3}],selectAttribute:2,fileDataList:[],dataLoading:!1,dialogChange:!1}},created:function(){this.searchData()},methods:{handleCommand:function(t,e){var a=this;this.$http.post(this.$api.CourseWareUpdateAttribute,{cid:e.id,attribute:t.value}).then(function(t){t.Result?a.searchData():a.$message({showClose:!0,message:"操作失败",type:"error"})}).catch(function(t){a.$message({showClose:!0,message:"操作失败",type:"error"})})},closeDialog:function(){},searchData:function(){var t=this;this.searchLoading=!0,this.dataList=[],this.selectFiles=[],this.preSelectFile=[],this.$http.get(this.$api.CourseWareList,{courseID:this.courseId,attribute:-1}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){t.dataList.push({id:e.Key.CID,materialId:e.Key.MaterialID,attribute:e.Key.Attribute,createTime:e.Key.CreateTime,state:e.Key.State,name:e.Value.MaterialName,size:e.Value.MaterialFileSize,fileType:e.Value.MaterialFileExt}),t.selectFiles.push(e.Key.MaterialID),t.preSelectFile.push(e.Key.MaterialID)}),e.Result&&(t.dataTotal=e.RowsCount||0),t.searchLoading=!1}).catch(function(e){t.searchLoading=!1})},getDict:function(){var t=this;this.dataLoading=!0,this.fileTypeOptions=[],this.$http.get(this.$api.MaterialTypeList,{token:this.$http.getToken()}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){t.fileTypeOptions.push({label:e.MTypename,value:e.MTypeID,code:e.MTCode})}),t.dataLoading=!1}).catch(function(e){t.dataLoading=!1})},deleteData:function(t){var e=this;this.$confirm("此操作将删除课件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.dataDelete([t.id],!0)}).catch(function(t){})},beforeShowAdd:function(){var t=this;this.fileDataList=[],this.$http.get(this.$api.CourseMaterialList,{token:this.$http.getToken()}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){t.fileDataList.push({name:e.MaterialName,materialId:e.MaterialID,size:e.MaterialFileSize,fileType:e.MaterialFileExt})})}).catch(function(t){}),this.showEdit=!0},beforeUpload:function(t){var e=this;if(t.size>524288e3)return this.$message({showClose:!0,message:"单个文件大小不能超过500MB",type:"error"}),!1;if(t.type.indexOf("cmd")>-1||t.type.indexOf("exe")>-1||t.type.indexOf("bat")>-1||t.type.indexOf("vbs")>-1)return this.$message({showClose:!0,message:"不支持的文件类型",type:"error"}),!1;var a=this.$http.getUser(),s=new FormData;s.append("stream",t),s.append("dirid",""),s.append("Token",this.$http.getToken()),s.append("courseId",this.courseId),s.append("username",a.UserName),s.append("attribute",this.selectAttribute);var i=this;i.progress=0;var n={onUploadProgress:function(t){i.progress=100*t.loaded/t.total|0}};return this.$http.postFormDataAndProgress(this.$api.CourseWareUpload,s,n).then(function(a){if(a.Result){e.$message({showClose:!0,message:"上传成功",type:"success"});var s={name:t.name,materialId:a.MaterialID,size:t.Size,fileType:t.type};e.dialogChange=!0,e.fileDataList.push(s),e.searchData()}else e.$message(o()({showClose:!0},a))}).catch(function(t){e.$message({showClose:!0,message:"上传失败",type:"error"})}),!1},selectFileChange:function(t){var e=this,a=this.selectFiles.filter(function(t){return-1===e.preSelectFile.indexOf(t)}),s=this.preSelectFile.filter(function(t){return-1===e.selectFiles.indexOf(t)});a.length>0?this.dataAdd(a):s.length>0&&this.dataDelete(this.dataList.map(function(t){if(s.indexOf(t.materialId)>-1)return t.id})),this.dialogChange=!0},dataAdd:function(t){var e=this;this.dataLoading=!0,this.$http.post(this.$api.CourseWareAdd,{courseID:this.courseId,materialIDs:t.join(","),attribute:this.selectAttribute}).then(function(a){a.Result?(e.searchData(),e.preSelectFile.push(t)):(e.$message(o()({showClose:!0},a)),e.selectFiles=e.preSelectFile),e.dataLoading=!1}).catch(function(t){e.$message({showClose:!0,message:"操作失败",type:"error"}),e.selectFiles=e.preSelectFile,e.dataLoading=!1})},dataDelete:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.dataLoading=!0,this.$http.post(this.$api.CourseWareDelete,{ids:t.join(",")}).then(function(t){t.Result?(e.searchData(),a&&e.$message({showClose:!0,message:"删除成功",type:"success"})):(e.$message(o()({showClose:!0},t)),e.selectFiles=e.preSelectFile),e.dataLoading=!1}).catch(function(t){e.$message({showClose:!0,message:"操作失败",type:"error"}),e.selectFiles=e.preSelectFile,e.dataLoading=!1})},studentTask:function(t){sessionStorage.setItem("courseWare",i()(t)),sessionStorage.setItem("taskType","CourseWare"),this.$router.push("/main/teacherSpace/prepare/studentTask")}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item"},[a("div",{staticClass:"tt"},[a("div",{staticClass:"tname"},[t._v("课件")]),t._v(" "),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary",size:"small",disabled:t.disabled},on:{click:t.beforeShowAdd}},[t._v("添加")])],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.searchLoading,expression:"searchLoading"}],attrs:{id:"table"}},[a("common-table",{attrs:{columns:t.dataColumns,datas:t.dataList,pagger:!1,"th-class":"table-innerhead",border:"","max-height":"550"},scopedSlots:t._u([{key:"attribute",fn:function(e){return[a("el-dropdown",{staticClass:"dropdown",on:{command:function(a){t.handleCommand(a,e.row)}}},[1==e.row.attribute?a("span",{staticClass:"el-dropdown-link"},[t._v("课前"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]):2==e.row.attribute?a("span",{staticClass:"el-dropdown-link"},[t._v("课中"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]):3==e.row.attribute?a("span",{staticClass:"el-dropdown-link"},[t._v("课后"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]):t._e(),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.attributeOptions,function(e,s){return a("el-dropdown-item",{key:s,attrs:{command:e}},[t._v(t._s(e.label)+"\n            ")])}),1)],1)]}},{key:"name",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}},{key:"size",fn:function(e){return[e.row.size>1048576?a("span",[t._v(t._s(Math.round(e.row.size/1024/10.24)/100)+"MB")]):a("span",[t._v(t._s(Math.round(e.row.size/10.24)/100)+"KB")])]}},{key:"createTime",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDate")(e.row.createTime,e.row.createTime)))])]}},{key:"oprate",fn:function(e){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.deleteData(e.row)}}},[t._v("移除")]),t._v(" "),2!=e.row.attribute?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.studentTask(e.row)}}},[t._v("学生完成进度\n        ")]):t._e()]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{title:"添加课件",visible:t.showEdit,width:"800px",center:""},on:{"update:visible":function(e){t.showEdit=e},close:t.closeDialog}},[a("div",{staticClass:"head_select"},[t._v("课件属性：\n      "),a("el-select",{staticStyle:{width:"150px"},attrs:{disabled:t.disabled},model:{value:t.selectAttribute,callback:function(e){t.selectAttribute=e},expression:"selectAttribute"}},t._l(t.attributeOptions,function(e,s){return a("el-option",{key:s,attrs:{label:e.label},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})}),1)],1),t._v(" "),a("div",{staticClass:"head_btn"},[a("el-upload",{ref:"upload",attrs:{action:"",limit:1,"before-upload":t.beforeUpload}},[a("el-button",{attrs:{size:"small",icon:"el-icon-upload",type:"primary"}},[t._v("上传课件")])],1),t._v(" "),a("div",{staticStyle:{"font-size":"12px"}},[t._v("单个文件大小不能超过500MB")]),t._v(" "),a("div",{staticStyle:{"text-align":"right"}},[t._v("\n        上传进度：\n        "),a("el-progress",{staticStyle:{width:"120px",float:"right","line-height":"20px"},attrs:{"text-inside":!0,"stroke-width":13,percentage:t.progress,status:"success"}})],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}]},[a("el-transfer",{attrs:{data:t.fileDataList,filterable:"",props:t.propsOption,titles:["网盘文件","备课文件"]},on:{change:t.selectFileChange},model:{value:t.selectFiles,callback:function(e){t.selectFiles=e},expression:"selectFiles"}})],1),t._v(" "),a("div",{staticClass:"foot_btn"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.showEdit=!1}}},[t._v("关 闭")])],1)])],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(t){a("OfL9")},"data-v-623b7ab9",null).exports,u={mixins:[l.a],props:{courseId:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{showEdit:!1,editTitle:!0,showPreview:!1,searchLoading:!1,dataColumns:[{prop:"attribute",label:"属性",slot:!0,width:100},{prop:"title",label:"题库名称"},{prop:"time",label:"答题计时(分)",width:120},{prop:"createTime",label:"创建时间",slot:!0,width:100},{prop:"oprate",label:"操作",slot:!0,width:350}],dataList:[],practiceBankList:[],formTitle:{id:"",plid:"",attribute:"",time:0},rulesTitle:{plid:{required:!0,message:"请选择试卷题库",trigger:"change"},attribute:{required:!0,message:"请选择练习属性",trigger:"change"},time:[{required:!0,message:"试卷计时不能为空"},{type:"number",message:"试卷计时必须为数字值"}]},attributeOptions:[{label:"课前",value:1},{label:"课中",value:2},{label:"课后",value:3}],subjectTypeOptions:[{label:"单选题",value:1},{label:"多选题",value:2},{label:"判断题",value:3},{label:"问答题",value:4}],singleOptions:["A","B","C","D","E","F","G","H"],judgeOptions:["对","错"],btnLoading:!1,dialogChange:!1,dataEdit:!1,dataInfo:{id:"",title:"",time:0,score:0,subjectActive:0,subjectList:[]}}},created:function(){this.searchData()},methods:{handleCommand:function(t,e){var a=this,s={cpID:e.id,courseID:this.courseId,plID:e.plid,attribute:t.value,cpTime:e.time};this.$http.post(this.$api.ClassPractiseAdd,s).then(function(t){t.Result?a.searchData():a.$message({showClose:!0,message:"操作失败",type:"error"})}).catch(function(t){a.$message({showClose:!0,message:"操作失败",type:"error"})})},closeDialog:function(){this.dialogChange&&this.searchData()},searchData:function(){var t=this;this.searchLoading=!0,this.dataList=[],this.$http.get(this.$api.ClassPractiseList,{courseID:this.courseId}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){t.dataList.push({id:e.Datas.CPID||"",plid:e.Datas.PLID||"",attribute:e.Datas.Attribute,time:e.Datas.CPTime||"",state:e.Datas.State||0,createTime:e.Datas.CreateTime||"",title:e.Title||""})}),e.Result&&(t.dataTotal=e.RowsCount||0),t.searchLoading=!1}).catch(function(e){t.searchLoading=!1})},resetFormTitle:function(t){this.formTitle={id:t?t.id:"",plid:t?t.plid:"",attribute:t?t.attribute:"",time:t?t.time:0}},addData:function(){this.dataEdit=!1,this.resetFormTitle(),this.getPracticeBankList(),this.showEdit=!0},editData:function(t){this.dataEdit=!0,this.resetFormTitle(t),this.getPracticeBankList(),this.showEdit=!0},saveFormTitle:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$message({showClose:!0,message:"请输入正确格式",type:"error"}),!1;e.btnLoading=!0;var a={cpID:e.formTitle.id,courseID:e.courseId,plID:e.formTitle.plid,attribute:e.formTitle.attribute,cpTime:e.formTitle.time};e.$http.post(e.$api.ClassPractiseAdd,a).then(function(t){t.Result?(e.dialogChange=!0,e.showEdit=!1,e.$message({message:e.formTitle.id?"修改成功！":"创建成功！",type:"success"})):t.message&&e.$message(o()({showClose:!0},t)),e.btnLoading=!1}).catch(function(t){e.btnLoading=!1})})},previewData:function(t){this.getData(t),this.showPreview=!0},getData:function(t){var e=this;this.dataInfo.subjectList=[],this.dataInfo.title=t.title||"",this.dataInfo.time=t.time||0,this.dataInfo.score=0,this.$http.get(this.$api.ClassPractiseSubjectList,{plid:t.plid}).then(function(t){t.Result&&t.Datas&&t.Datas.length>0&&t.Datas.forEach(function(t){e.dataInfo.subjectList.push({plid:t.Key.PLID,id:t.Key.PSID,no:t.Key.PSSerial||0,title:t.Key.PSContent,type:t.Key.PSType,score:t.Key.PSScore||0,analysis:t.Key.PSanalysis,answer:t.Key.PSAnswer,multiAnswer:2!==t.Key.PSType?[]:t.Key.PSAnswer.split(""),options:4===t.Key.PSType?[]:t.Value.map(function(t){return{label:t.SOContent,value:t.SOSerial}})}),e.dataInfo.score+=t.Key.PSScore||0})}).catch(function(t){})},deleteData:function(t){var e=this;this.$confirm("此操作将删除随堂练习, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(e.$api.ClassPractiseDelete,{ids:t.id}).then(function(t){t.Result?(e.$message({showClose:!0,message:"删除成功",type:"success"}),e.searchData()):e.$message(o()({showClose:!0},t))}).catch(function(t){e.$message({showClose:!0,message:"操作失败",type:"error"})})}).catch(function(t){})},getPracticeBankList:function(){var t=this;this.practiceBankList=[],this.$http.get(this.$api.PracticeBankList,{token:this.$http.getToken()}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){t.practiceBankList.push({label:e.PLTitle||"",value:e.PLID||""})})}).catch(function(e){t.searchLoading=!1})},closePreviewDialog:function(){this.dataEdit=!1},studentTask:function(t){sessionStorage.setItem("classPractice",i()(t)),sessionStorage.setItem("taskType","ClassPractice"),this.$router.push("/main/teacherSpace/prepare/studentTask")}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"item"},[a("div",{staticClass:"tt"},[a("div",{staticClass:"tname"},[t._v("随堂练习")]),t._v(" "),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.$router.push("/main/teacherSpace/practiceBank")}}},[t._v("我的题库\n        ")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small",disabled:t.disabled},on:{click:t.addData}},[t._v("练习添加")])],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.searchLoading,expression:"searchLoading"}],staticClass:"table"},[a("common-table",{attrs:{columns:t.dataColumns,datas:t.dataList,pagger:!1,"th-class":"table-innerhead",border:"","max-height":"550"},scopedSlots:t._u([{key:"attribute",fn:function(e){return[a("el-dropdown",{staticClass:"dropdown",on:{command:function(a){t.handleCommand(a,e.row)}}},[1==e.row.attribute?a("span",{staticClass:"el-dropdown-link"},[t._v("课前"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]):2==e.row.attribute?a("span",{staticClass:"el-dropdown-link"},[t._v("课中"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]):3==e.row.attribute?a("span",{staticClass:"el-dropdown-link"},[t._v("课后"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]):t._e(),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.attributeOptions,function(e,s){return a("el-dropdown-item",{key:s,attrs:{command:e,disabled:t.disabled}},[t._v(t._s(e.label))])}),1)],1)]}},{key:"createTime",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDate")(e.row.createTime,e.row.createTime)))])]}},{key:"oprate",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini",disabled:t.disabled},on:{click:function(a){t.editData(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){t.previewData(e.row)}}},[t._v("预览")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini",disabled:t.disabled},on:{click:function(a){t.deleteData(e.row)}}},[t._v("移除")]),t._v(" "),2!==e.row.attribute?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.studentTask(e.row)}}},[t._v("学生完成进度")]):t._e()]}}])})],1)]),t._v(" "),a("el-dialog",{attrs:{title:t.dataEdit?"随堂练习修改":"随堂练习创建",visible:t.showEdit,width:"600px",center:""},on:{"update:visible":function(e){t.showEdit=e},close:t.closeDialog}},[a("el-form",{ref:"formTitle",attrs:{model:t.formTitle,rules:t.rulesTitle,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"试卷题库",prop:"plid"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择试卷题库"},model:{value:t.formTitle.plid,callback:function(e){t.$set(t.formTitle,"plid",e)},expression:"formTitle.plid"}},t._l(t.practiceBankList,function(e,s){return a("el-option",{key:s,attrs:{label:e.label},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"练习属性",prop:"attribute"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择练习属性"},model:{value:t.formTitle.attribute,callback:function(e){t.$set(t.formTitle,"attribute",e)},expression:"formTitle.attribute"}},t._l(t.attributeOptions,function(e,s){return a("el-option",{key:s,attrs:{label:e.label},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"答题计时",prop:"time"}},[a("el-input-number",{attrs:{min:1,max:1e3,label:"试卷计时","controls-position":"right",precision:0,step:1},model:{value:t.formTitle.time,callback:function(e){t.$set(t.formTitle,"time",e)},expression:"formTitle.time"}}),t._v("\n        分钟\n      ")],1),t._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(e){t.showEdit=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:function(e){t.saveFormTitle("formTitle")}}},[t._v("\n          保存\n        ")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"随堂练习预览",visible:t.showPreview,width:"800px",center:""},on:{"update:visible":function(e){t.showPreview=e},close:t.closePreviewDialog}},[a("div",{staticClass:"pre_title"},[a("span",[t._v("题库名称：")]),t._v(" "),a("span",[t._v(t._s(t.dataInfo.title))])]),t._v(" "),a("div",{staticClass:"pre_line"},[a("span",[t._v("试卷计时：")]),t._v(" "),a("span",[t._v(t._s(t.dataInfo.time))]),t._v(" "),a("span",[t._v("总题数：")]),t._v(" "),a("span",[t._v(t._s(t.dataInfo.subjectList.length))]),t._v(" "),a("span",[t._v("总分数：")]),t._v(" "),a("span",[t._v(t._s(t.dataInfo.score))])]),t._v(" "),a("el-collapse",{staticClass:"collapse_main",attrs:{accordion:""},model:{value:t.dataInfo.subjectActive,callback:function(e){t.$set(t.dataInfo,"subjectActive",e)},expression:"dataInfo.subjectActive"}},t._l(t.dataInfo.subjectList,function(e,s){return a("el-collapse-item",{key:s,attrs:{name:s}},[a("template",{slot:"title"},[a("el-row",{staticClass:"collapse_head",attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("span",[t._v(t._s(s+1+"、["+t.subjectTypeOptions[e.type-1].label+"]"+e.title))])])],1)],1),t._v(" "),a("el-card",{staticClass:"collapse_card"},[[1,2].indexOf(e.type)>-1?a("div",[a("h4",[t._v("选项：")]),t._v(" "),t._l(e.options,function(e,s){return a("p",{key:s},[t._v(t._s(e.value+"、"+e.label))])})],2):t._e(),t._v(" "),a("h4",[t._v("答案：")]),t._v(" "),a("div",{staticClass:"card_line"},[a("span",[t._v("正确答案：")]),t._v(" "),a("span",[t._v(t._s(2===e.type?e.multiAnswer.join(""):e.answer))]),t._v(" "),a("span",[t._v("分数：")]),t._v(" "),a("span",[t._v(t._s(e.score))])]),t._v(" "),a("h4",[t._v("解析：")]),t._v(" "),a("div",{staticClass:"card_content"},[t._v(t._s(e.analysis))])])],2)}),1),t._v(" "),a("div",{staticStyle:{"text-align":"right","margin-top":"15px"}},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.showPreview=!1}}},[t._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(u,p,!1,function(t){a("BhC5")},"data-v-364156d8",null).exports,m={mixins:[l.a],props:{courseId:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{showEdit:!1,searchLoading:!1,dataColumns:[{prop:"PGSContent",label:"题目"},{prop:"CreateTime",slot:!0,label:"创建时间"},{prop:"oprate",label:"操作",slot:!0,width:220}],dataList:[],form:{id:"",title:"",time:0},rules:{title:{required:!0,min:1,max:500,message:"长度在 1 到 500 个字符",trigger:"blur"},time:[{required:!0,message:"试卷计时不能为空"},{type:"number",message:"试卷计时必须为数字值"}]},btnLoading:!1}},created:function(){this.searchData()},methods:{searchData:function(){var t=this;this.searchLoading=!0,this.dataList=[],this.$http.get(this.$api.GroupDiscussionList,{courseID:this.courseId}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){t.dataList.push(e)}),e.Result&&(t.dataTotal=e.RowsCount||0),t.searchLoading=!1}).catch(function(e){t.searchLoading=!1})},editData:function(t){this.form.id=t.PGSID,this.form.title=t.PGSContent,this.showEdit=!0},saveData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$message({showClose:!0,message:"请输入正确格式",type:"error"}),!1;e.btnLoading=!0;var a={pgsID:e.form.id,courseID:e.courseId,pgsContent:e.form.title,pgsTime:e.form.time};e.$http.post(e.$api.GroupDiscussionAdd,a).then(function(t){t.Result?(e.$message({message:"保存成功！",type:"success"}),setTimeout(function(){e.searchData()},100),e.showEdit=!1):t.message&&e.$message(o()({showClose:!0},t)),e.btnLoading=!1}).catch(function(t){e.btnLoading=!1})})},deleteData:function(t){var e=this;this.$confirm("此操作将删除小组讨论, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(e.$api.GroupDiscussionDelete,{ids:t.PGSID}).then(function(t){t.Result?(e.$message({showClose:!0,message:"删除成功",type:"success"}),e.searchData()):e.$message(o()({showClose:!0},t))}).catch(function(t){e.$message({showClose:!0,message:"操作失败",type:"error"})})}).catch(function(t){})},beforeShowAdd:function(){this.resetForm(),this.showEdit=!0},resetForm:function(){this.form={id:"",title:"",time:0}}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"item"},[a("div",{staticClass:"tt"},[a("div",{staticClass:"tname"},[t._v("小组讨论")]),t._v(" "),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary",size:"small",disabled:t.disabled},on:{click:t.beforeShowAdd}},[t._v("添加")])],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.searchLoading,expression:"searchLoading"}],staticClass:"table"},[a("common-table",{attrs:{columns:t.dataColumns,datas:t.dataList,pagger:!1,"th-class":"table-innerhead",border:"","max-height":"550"},scopedSlots:t._u([{key:"CreateTime",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDate")(e.row.CreateTime,e.row.CreateTime)))])]}},{key:"oprate",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini",disabled:t.disabled},on:{click:function(a){t.editData(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini",disabled:t.disabled},on:{click:function(a){t.deleteData(e.row)}}},[t._v("移除")])]}}])})],1)]),t._v(" "),a("el-dialog",{attrs:{title:"编辑小组讨论",visible:t.showEdit,width:"600px",center:""},on:{"update:visible":function(e){t.showEdit=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small"}},[a("el-form-item",{attrs:{prop:"title"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:10},placeholder:"请输入小组讨论题目",maxlength:"500","show-word-limit":!0},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:function(e){t.saveData("form")}}},[t._v("保 存")]),t._v(" "),a("el-button",{on:{click:function(e){t.showEdit=!1}}},[t._v("取 消")])],1)],1)],1)],1)},staticRenderFns:[]};var v=a("VU/8")(m,f,!1,function(t){a("gDl7")},"data-v-3e0b15b0",null).exports,g=a("oAV5"),b={name:"",components:{CourseWare:d,ClassPractice:h,Discussion:v},props:{},data:function(){return{course:JSON.parse(sessionStorage.getItem("course")),courseID:sessionStorage.getItem("courseID"),activeName:"second"}},beforeCreate:function(){sessionStorage.getItem("course")||this.$router.push("/main/teacherSpace/prepare/courseView")},created:function(){},methods:{formatDate:function(t,e){return Object(g.b)(t,e)},handleClick:function(t,e){console.log(t,e)}},computed:{},watch:{}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"lesson-info"}},[a("div",{staticClass:"top"},[a("div",{staticClass:"tt"},[t._v("课程信息")]),t._v(" "),a("div",{staticClass:"lname"},[t._v("课程："+t._s(t.course.CourseName)+"\n      "),0===t.course.State?a("span",{staticStyle:{color:"#67c23a"}},[t._v("(准备中)")]):1===t.course.State?a("span",{staticStyle:{color:"#409eff"}},[t._v("(上课中)")]):a("span",{staticStyle:{color:"#f56c6c"}},[t._v("(已结束)")])]),t._v(" "),a("div",{staticClass:"info"},[a("div",{staticClass:"tc"},[a("i",{staticClass:"iconfont icon-jiaoshi"}),t._v("\n        老师："+t._s(t.course.TeacherName)+"\n      ")]),t._v(" "),a("div",{staticClass:"cs"},[a("i",{staticClass:"iconfont icon-jiaoshianpai"}),t._v("\n        教室："+t._s(t.course.ClassroomName)+"\n      ")]),t._v(" "),a("div",{staticClass:"gd"},[a("i",{staticClass:"iconfont icon-banji2"}),t._v("\n        班级："+t._s(t.course.ClassName)+"\n      ")]),t._v(" "),a("div",{staticClass:"ltime"},[a("i",{staticClass:"iconfont icon-shizhong3"}),t._v("\n        上课时间："+t._s(t.formatDate(t.course.ClassDate,"yyyy年MM月dd日")+" "+t.formatDate(t.course.StartTime,"hh:mm")+"-"+t.formatDate(t.course.EndTime,"hh:mm"))+"\n      ")])])]),t._v(" "),a("div",{staticClass:"main"},[a("div",{staticClass:"tt"},[t._v("备课流程")]),t._v(" "),a("div",{staticClass:"tabs"},[a("div",{staticClass:"content"},[a("course-ware",{attrs:{"course-id":t.courseID,disabled:!1}}),t._v(" "),a("class-practice",{attrs:{"course-id":t.courseID,disabled:!1}}),t._v(" "),a("discussion",{attrs:{"course-id":t.courseID,disabled:!1}})],1)])])])},staticRenderFns:[]};var w=a("VU/8")(b,_,!1,function(t){a("q57x")},null,null);e.default=w.exports},gDl7:function(t,e){},q57x:function(t,e){}});
//# sourceMappingURL=21.2023122814742.js.map