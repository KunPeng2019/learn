webpackJsonp([28],{4866:function(t,e){},Nzfg:function(t,e){},Za75:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),n=a.n(s),i=a("Dd8w"),o=a.n(i),r=a("7GJr"),c=a("oAV5"),l=a("Glv5"),u=a.n(l),d={name:"StudentQuestion",props:{course:{type:Object}},data:function(){return{dataList:[],studentQuestion:[],defaultPhotoImg:u.a,selectStudentId:"",listLoading:!1,courseState:{before:0,at:1,after:2},questionList:[],questionTabOptions:[],questionTabSelected:""}},created:function(){},methods:{formatDate:function(t,e){return Object(c.b)(t,e)},courseQuestion:function(){this.questionTabOptions=[];var t=this.course.State;t===this.courseState.before?this.questionTabOptions=[{index:"0",attribute:1,label:"预习",disabled:!1,dataList:[],dataPerson:[]}]:t===this.courseState.at?this.questionTabOptions=[{index:"0",attribute:1,label:"预习",disabled:!0,dataList:[],dataPerson:[]},{index:"1",attribute:2,label:"课中",disabled:!1,dataList:[],dataPerson:[]}]:t===this.courseState.after&&(this.questionTabOptions=[{index:"0",attribute:1,label:"预习",disabled:!0,dataList:[],dataPerson:[]},{index:"1",attribute:2,label:"课中",disabled:!0,dataList:[],dataPerson:[]},{index:"2",attribute:3,label:"复习",disabled:!1,dataList:[],dataPerson:[]}]),this.questionTabSelected=this.questionTabOptions[t].index,this.GetStudentQuestion()},GetStudentQuestion:function(){var t=this,e=[],a=[];this.$http.get(this.$api.GetQuestionAllDatas,{courseID:this.course.CourseID,classID:this.course.ClassID,attribute:this.questionTabOptions[this.questionTabSelected].attribute}).then(function(s){s.Result&&s.Datas&&s.Datas.length>0&&(s.Datas.forEach(function(t){e.push(t);var s=a.findIndex(function(e){return e.StudentID===t.StudentID});s>-1?a[s].Questions.push(t):a.push({StudentID:t.StudentID,StudentName:t.StudentName,Questions:[t]})}),t.questionTabOptions[t.questionTabSelected].dataList=e,t.questionTabOptions[t.questionTabSelected].dataPerson=a)})}},computed:{},watch:{course:function(t,e){this.courseQuestion()}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sub_module"},[a("el-tabs",{on:{"tab-click":t.GetStudentQuestion},model:{value:t.questionTabSelected,callback:function(e){t.questionTabSelected=e},expression:"questionTabSelected"}},t._l(t.questionTabOptions,function(e,s){return a("el-tab-pane",{key:s,attrs:{label:e.label,name:e.index}},[e.dataList&&e.dataList.length>0?a("el-row",{staticStyle:{border:"1px solid #f3f3f3"}},[a("el-col",{attrs:{span:18}},[a("div",{ref:"chat",refInFor:!0,staticClass:"chat"},[a("div",{staticClass:"chat_content"},t._l(e.dataList,function(e,s){return a("div",{key:s,class:e.StudentID!==t.selectStudentId?"chat_item":"chat_item checked_item"},[a("div",{staticClass:"chat_news"},[a("div",{staticClass:"chat_news_name"},[t._v("\n                    "+t._s(e.StudentName)+"\n                    "),a("span",[t._v(t._s(t.formatDate(e.CreateTime,"hh:mm:ss")))])]),t._v(" "),a("div",{staticClass:"chat_news_cont"},[a("span",[t._v(t._s(e.QContent))])])])])}),0)])]),t._v(" "),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"summary"},[t._v("提问人员")]),t._v(" "),a("div",{staticClass:"list_person"},t._l(e.dataPerson,function(e,s){return a("div",{key:s,staticClass:"person_item",class:t.selectStudentId===e.StudentID?"person_selected":"",on:{click:function(a){t.selectStudentId=e.StudentID}}},[a("img",{attrs:{src:t.defaultPhotoImg,alt:""}}),t._v(" "),a("span",[t._v(t._s(e.StudentName))]),t._v(" "),a("span")])}),0)])],1):a("div",{staticStyle:{"text-align":"center"}},[t._v("\n        暂无提问\n      ")])],1)}),1)],1)},staticRenderFns:[]};var p=a("VU/8")(d,h,!1,function(t){a("4866")},"data-v-76382788",null).exports,m=a("6jqi"),f={name:"",components:{commonTable:r.a,StudentQuestion:p},mixins:[m.a],props:{},data:function(){return{weekCount:0,weekName:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],weekData:[],weekIndex:0,dateRange:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},formData:{startDate:"",endDate:"",thcid:this.$http.getThc().TeacherID,psize:10,pno:1},tableColumns:[{prop:"CourseName",label:"课程名称"},{prop:"ClassName",label:"班级"},{prop:"ClassroomName",label:"教室"},{prop:"ClassDate",label:"上课日期",slot:!0,width:110},{prop:"StartTime",label:"上课时间",slot:!0,width:120},{prop:"State",label:"状态",slot:!0,width:80},{prop:"oprate",label:"操作",slot:!0,align:"right",width:266}],tableDatas:[],dataTotal:0,keyIdName:"CourseID",selectedIds:[],deleteLoading:!1,listLoading:!1,dialogCourseVisible:!1,courseDatas:[],statsTC:[{prop:"CourseName",label:"课程名称"},{prop:"ClassName",label:"班级名称"},{prop:"oprate",label:"操作",slot:!0}],dialogAttendanceVisible:!1,attendanceDatas:[],attendanceParas:[],attendanceDateRange:[],attendanceTC:[{prop:"StudentName",label:"姓名",sort:!0},{prop:"Normal",label:"正常",sort:!0},{prop:"Late",label:"迟到",sort:!0},{prop:"Leave",label:"请假",sort:!0},{prop:"Truancy",label:"旷课",sort:!0}],questionCourse:{},dialogQuestionVisible:!1}},computed:{},watch:{},created:function(){this.total=this.tableDatas.length,this.init()},mounted:function(){},methods:{init:function(){this.weekIndex=(new Date).getDay()-1,this.weekIndex=-1===this.weekIndex?6:this.weekIndex,this.dateRange=[],this.weekDataChange(0)},weekDataChange:function(t){this.weekCount+=t,this.weekData=[];for(var e=0;e<7;e++)this.weekData.push({date:Object(c.d)(e,this.weekCount),total:0});this.getCourseStatistics(),this.selectDate(this.weekData[this.weekIndex],this.weekIndex)},pageChange:function(t){this.formData.pno=t,this.searchData()},selectDate:function(t,e){this.weekIndex=e,this.formData.startDate=t.date,this.formData.endDate=t.date,this.searchData()},selectDateRange:function(){2===this.dateRange.length&&(this.formData.startDate=this.dateRange[0],this.formData.endDate=this.dateRange[1],this.weekIndex=-1)},searchData:function(){var t=this;this.tableDatas=[],this.$http.get(this.$api.GetScheduleDatas,{userID:this.$http.getUser().UserID,teacherID:this.$http.getThc().TeacherID,startTime:this.formData.startDate,endTime:this.formData.endDate}).then(function(e){t.$http.get(t.$api.CourseList,t.formData).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){t.tableDatas.push(e)}),e.Result&&(t.dataTotal=e.RowsCount||0)}).catch(function(t){})}).catch(function(t){})},getCourseStatistics:function(){var t=this;this.$http.get(this.$api.CourseStats,{startDate:this.weekData[0].date,endDate:this.weekData[6].date,thcid:this.$http.getThc().TeacherID}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e){var a=e.ClassDate?Object(c.f)(new Date(e.ClassDate),"{y}-{m}-{d}"):"",s=t.weekData.findIndex(function(t){return t.date===a});t.weekData[s].total=e.Total})}).catch(function(t){})},courseAdd:function(){this.$router.push("/main/teacherSpace/prepare/classTemplate")},deleteData:function(){var t=this;this.selectedIds.length<1?this.$message({showClose:!0,message:"请选择课程",type:"error"}):this.$confirm("此操作将删除课程, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteLoading=!0,t.$http.post(t.$api.CourseUpdateState,{ids:t.selectedIds.join(","),state:"-1"}).then(function(e){e.Result?(t.$message({message:"删除成功！",type:"success"}),setTimeout(function(){console.log(t.selectedIds.length),t.weekData[t.weekIndex].total=t.weekData[t.weekIndex].total-t.selectedIds.length,t.selectedIds=[],t.searchData()},1)):e.message&&t.$message(o()({showClose:!0},e)),t.deleteLoading=!1}).catch(function(e){t.$message({showClose:!0,message:"删除失败",type:"error"}),t.deleteLoading=!1})}).catch(function(){})},selectChange:function(t){this.selectedIds=t},courseEdit:function(t){this.$router.push({path:"/main/teacherSpace/prepare/createCourse",query:{courseId:t.CourseID}})},coursePrepare:function(t){sessionStorage.setItem("course",n()(t)),sessionStorage.setItem("courseID",t.CourseID),this.$router.push("/main/teacherSpace/prepare/lessonInfo")},courseRecord:function(t){sessionStorage.setItem("course",n()(t)),sessionStorage.setItem("courseID",t.CourseID),this.$router.push("/main/teacherSpace/prepare/classRecord")},studentCourseStats:function(){var t=this;this.dialogCourseVisible=!0,this.courseDatas=[],this.$http.get(this.$api.GetDatasByTeacherID,{teacherID:this.$http.getThc().TeacherID}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e,a){t.courseDatas.push({CourseID:e.CourseID,CourseName:e.CourseName,ClassID:e.ClassID,ClassName:e.ClassName})}),t.listLoading=!1}).catch(function(e){t.listLoading=!1})},searchAttendance:function(){var t=this;this.attendanceDatas=[],this.$http.get(this.$api.GetSignStatsByDate,{startDate:this.attendanceDateRange[0],endDate:this.attendanceDateRange[1],courseName:this.attendanceParas[0].CourseName,classID:this.attendanceParas[0].ClassID,className:this.attendanceParas[0].ClassName}).then(function(e){e.Result&&e.Datas&&e.Datas.length>0&&e.Datas.forEach(function(e,a){t.attendanceDatas.push({StudentID:e.StudentID,StudentName:e.StudentName,Normal:e.Normal,Late:e.Late,Leave:e.Leave,Truancy:e.Truancy})}),t.listLoading=!1}).catch(function(e){t.listLoading=!1})},attendanceSatas:function(t){this.attendanceDatas=[],this.attendanceParas=[],this.dialogAttendanceVisible=!0,this.attendanceParas.push({CourseName:t.CourseName,ClassID:t.ClassID,ClassName:t.ClassName})},resetForm:function(){this.attendanceDateRange=[],this.dialogAttendanceVisible=!1},courseQuestion:function(t){var e=this;this.questionCourse=t,this.dialogQuestionVisible=!0,setTimeout(function(){e.$refs.studentQuestion.courseQuestion()},100)},timeFormat:function(t){return t.length<8?t:t.substring(0,t.length-3)}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"course-view"}},[a("div",{staticClass:"main"},[a("div",{staticClass:"top"},[a("div",{staticClass:"tt"},[t._v("我的课程")]),t._v(" "),a("div",{staticClass:"top_operate"},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{size:"small",type:"daterange",align:"right","unlink-panels":"",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},on:{change:t.selectDateRange},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}}),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.searchData}},[t._v("搜索")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.courseAdd}},[t._v("创建课程")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.studentCourseStats}},[t._v("学生课程统计")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small",loading:t.deleteLoading},on:{click:t.deleteData}},[t._v("批量删除")])],1)]),t._v(" "),a("div",{staticClass:"filter-date"},[a("div",{staticClass:"date"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.weekDataChange(-1)}}},[t._v("上一周")]),t._v(" "),t._l(t.weekData,function(e,s){return a("div",{key:s,staticClass:"item",class:t.weekIndex===s?"active":"",on:{click:function(a){t.selectDate(e,s)}}},[a("div",{staticClass:"info"},[a("div",{staticClass:"day"},[t._v(t._s(t.weekName[s]))]),t._v(" "),a("div",{staticClass:"dt"},[t._v(t._s(e.date))]),t._v(" "),a("div",{staticClass:"nus"},[t._v(t._s(e.total))])])])}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.weekDataChange(1)}}},[t._v("下一周")])],2)]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"table"},[a("common-table",{attrs:{columns:t.tableColumns,datas:t.tableDatas,"th-class":"table-innerhead",border:"",select:!0,pagger:!1,"data-id":t.keyIdName},on:{selectHandler:t.selectChange},scopedSlots:t._u([{key:"ClassDate",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDate")(e.row.ClassDate,e.row.ClassDate)))])]}},{key:"StartTime",fn:function(e){return[a("span",[t._v(t._s(t.timeFormat(e.row.StartTime))+" - "+t._s(t.timeFormat(e.row.EndTime)))])]}},{key:"State",fn:function(e){return[0==e.row.State?a("span",[t._v("未上课")]):t._e(),t._v(" "),1==e.row.State?a("span",[t._v("上课中")]):t._e(),t._v(" "),2==e.row.State?a("span",[t._v("已结束")]):t._e()]}},{key:"oprate",fn:function(e){return[a("el-button",{attrs:{type:"warning",plain:"",size:"mini"},on:{click:function(a){t.coursePrepare(e.row)}}},[t._v("备课\n            ")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.courseQuestion(e.row)}}},[t._v("学生提问\n            ")]),t._v(" "),0==e.row.State&&0==e.row.IsSchedule?a("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:function(a){t.courseEdit(e.row)}}},[t._v("编辑\n            ")]):t._e(),t._v(" "),0!=e.row.State?a("el-button",{staticStyle:{background:"#6acfce","border-color":"#6acfce"},attrs:{type:"primary",size:"mini"},on:{click:function(a){t.courseRecord(e.row)}}},[t._v("课堂记录\n            ")]):t._e()]}}])}),t._v(" "),a("div",{staticClass:"personal-bottom-pager"},[a("el-pagination",{staticClass:"personnal-detail-wrap-pager",attrs:{layout:"prev, pager, next","current-page":t.formData.pno,"page-size":t.formData.psize,total:t.dataTotal,"prev-text":"上一页","next-text":"下一页"},on:{"update:currentPage":function(e){t.$set(t.formData,"pno",e)},"current-change":t.pageChange}})],1)],1)])]),t._v(" "),a("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"学生课程",visible:t.dialogCourseVisible},on:{"update:visible":function(e){t.dialogCourseVisible=e}}},[a("common-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{columns:t.statsTC,datas:t.courseDatas,"th-class":"table-innerhead",border:"",pagger:!1},scopedSlots:t._u([{key:"oprate",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){t.attendanceSatas(e.row)}}},[t._v("考勤")])]}}])})],1),t._v(" "),a("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"学生考勤",visible:t.dialogAttendanceVisible,"before-close":t.resetForm},on:{"update:visible":function(e){t.dialogAttendanceVisible=e}}},[a("div",{staticClass:"attendance-search"},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{size:"small",type:"daterange",align:"right","unlink-panels":"",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.attendanceDateRange,callback:function(e){t.attendanceDateRange=e},expression:"attendanceDateRange"}}),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.searchAttendance}},[t._v("搜索")])],1),t._v(" "),a("common-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{columns:t.attendanceTC,datas:t.attendanceDatas,"th-class":"table-innerhead",border:"",pagger:!1}})],1),t._v(" "),a("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"学生提问",visible:t.dialogQuestionVisible},on:{"update:visible":function(e){t.dialogQuestionVisible=e}}},[a("student-question",{ref:"studentQuestion",attrs:{course:t.questionCourse}})],1)],1)},staticRenderFns:[]};var D=a("VU/8")(f,g,!1,function(t){a("Nzfg")},"data-v-6a948aa2",null);e.default=D.exports}});
//# sourceMappingURL=28.2023122814742.js.map